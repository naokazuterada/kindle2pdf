# Kindle書籍 自動スクショ・プロジェクト

Kindle書籍を自動でスクリーンショット撮影し、NotebookLMに読み込ませるためのワークフローです。

作成時のやりとり
https://gemini.google.com/app/2d79c34f2b3802f7?hl=ja

## フォルダ構成

- `venv/` : Python仮想環境（システムを汚さず実行するための環境）
- `1_check_pos.py` : マウスの座標を確認するためのスクリプト
- `2_kindle_scan.py` : 自動撮影を実行するメインスクリプト
- `3_create_pdf.py` : 撮影した画像をPDFに変換するスクリプト
- `output/` : 出力フォルダ（実行時に自動生成）
  - `screenshots/` : 撮影された画像が保存される
  - `book.pdf` : 生成されたPDFファイル

## 事前準備（macOS設定）

pyautoguiが画面操作を行うために、以下の許可が必要です。

1. **システム設定** > **プライバシーとセキュリティ** > **アクセシビリティ** を開く
2. **ターミナル**（または使用しているエディタ）を ON にする

### 実行前の注意事項

- **Kindleは最初のページを開いておく**: スクリプト実行前に、撮影を開始したいページを表示しておいてください
- **外部ディスプレイは外す**: 複数ディスプレイ環境では座標がずれる可能性があるため、外部ディスプレイを外した状態で実行してください

## 使い方（手順）

### 1. 仮想環境を有効にする

ターミナルを開くたびに、このコマンドを実行して環境をアクティベートしてください。

```bash
source venv/bin/activate
```

> ターミナルの先頭に `(venv)` と表示されれば成功です。

### 2. マウスの座標を確認する

ページめくりをキー入力（矢印キー）ではなく、クリックで行いたい場合に実行します。

```bash
python3 1_check_pos.py
```

- 実行後、5秒以内にKindleの「ページ送りボタン」の上にマウスを置いて待機
- 表示された `Point(x=..., y=...)` の数値をメモしてください

### 3. 自動スクショを実行する

```bash
python3 2_kindle_scan.py
```

- 実行後、5秒以内にKindleアプリを最前面に表示し、最初のページを開きます
- 設定したページ数分、自動で「撮影 → めくり」が繰り返されます

### 4. 仮想環境を終了する

作業が終わったら、以下のコマンドで環境を抜けます。

```bash
deactivate
```

## PDF化とNotebookLMへのアップロード

### 方法1: スクリプトを使う（推奨）

```bash
python3 3_create_pdf.py
```

`output/screenshots/` 内の画像をファイル名順に結合して `output/book.pdf` を出力します。

### 方法2: macOSのクイックアクションを使う

1. `output/screenshots/` フォルダを開く
2. 全ての画像を選択し、右クリック > **クイックアクション** > **PDFを作成** を選択

### NotebookLMへのアップロード

出来上がったPDFを [NotebookLM](https://notebooklm.google.com/) にアップロードします。

> NotebookLMが自動で高精度なOCRを行うため、画像PDFのままで問題ありません。

## スクリプトの調整のコツ

| 問題 | 解決方法 |
|------|----------|
| ページがめくれない | `2_kindle_scan.py` の `pyautogui.press('right')` を `pyautogui.click(x, y)` に書き換える |
| 画像が真っ白になる | KindleのDRM保護により標準のスクショが制限されている可能性あり。`INTERVAL`を長めにするか、フルスクリーンモードを解除する |
